webpackJsonp([1],{GcMe:function(t,e,n){var a=n("y4E4");"string"==typeof a&&(a=[[t.i,a,""]]);var o={hmr:!0};o.transform=void 0;n("MTIv")(a,o);a.locals&&(t.exports=a.locals)},Ki9h:function(t,e){t.exports=[["name","desc","sym","lat","lon"],["1A","Peveril Ledge","R","50.60683333","-1.935"],["1B","Poole Bar No 1","G","50.65483333","-1.919"],["1C","MS Amlin","Y","50.67183333","-1.900333333"],["1E","Christchurch Ledge Buoy","Y","50.69166667","-1.693333333"],["1F","Needles Fairway","RW","50.63733333","-1.649666667"],["1G","South West Shingles","R","50.65483333","-1.625333333"],["1H","Bridge","YBY","50.6605","-1.614666667"],["1J","Shingles Elbow","R","50.67283333","-1.600833333"],["1K","North Head","G","50.7115","-1.592"],["1L","Needles Lighthouse","RW","50.66216667","-1.591666667"],["1M","Warden","G","50.69133333","-1.559166667"],["1N","North East Shingles","BYB","50.69933333","-1.556833333"],["2A","Hurst","Y","50.71316667","-1.542166667"],["2B","Dunford","Y","50.723","-1.525666667"],["2C","Colten","Y","50.7305","-1.514333333"],["2F","Berthon","Y","50.73666667","-1.487"],["2H","“H”","Y","50.73833333","-1.469333333"],["2J","Zwerver","Y","50.75183333","-1.455666667"],["2K","1851 Trust","Y","50.74716667","-1.434833333"],["2R","Powder Byrne","Y","50.75716667","-1.4315"],["2T","Lymington Bank","R","50.71833333","-1.514166667"],["2X","Solent Bank","R","50.73716667","-1.456166667"],["20","Sconce","BY","50.70883333","-1.523833333"],["21","Black Rock","G","50.7095","-1.509833333"],["22","Charles Stanley Wealth Managers","Y","50.71433333","-1.49"],["24","The English Summer Berry Co","Y","50.71433333","-1.473666667"],["25","Caldwells Estate Agents","Y","50.71916667","-1.458166667"],["26","Hamstead Ledge","G","50.73116667","-1.436333333"],["27","Alitex","Y","50.71616667","-1.469333333"],["3A","West Lepe","R","50.754","-1.4015"],["3B","Newtown East","Y","50.73633333","-1.3965"],["3C","craftinsure.com","Y","50.76066667","-1.385333333"],["3D","Salt Mead","G","50.74183333","-1.384"],["3E","Dick Johnson","Y","50.76883333","-1.369833333"],["3F","elephantboatyard.co.uk","Y","50.74383333","-1.364666667"],["3G","Sevenstar Yacht Transport","Y","50.77633333","-1.357666667"],["3H","East Lepe","R","50.7655","-1.351166667"],["3K","Lepe Spit","YB","50.77966667","-1.344"],["3L","Gurnard Ledge","G","50.7585","-1.343166667"],["3N","Quinnell","Y","50.7845","-1.331333333"],["3P","Cowes Yacht Haven","Y","50.76133333","-1.333"],["3Q","East Bay","Y","50.76616667","-1.324166667"],["3R","North East Gurnard","R","50.78433333","-1.323666667"],["3S","Royal Thames","Y","50.79683333","-1.320833333"],["3T","KMS","Y","50.76833333","-1.3145"],["3U","Gurnard","BY","50.77033333","-1.314"],["3V","West Bramble","YBY","50.78666667","-1.310833333"],["3W","Williams Shipping","Y","50.78666667","-1.309166667"],["3X","Party","Y","50.76833333","-1.307166667"],["3Y","West Knoll","Y","50.7905","-1.297333333"],["3Z","Trinity House Buoy","Y","50.77183333","-1.295833333"],["30","RORC","Y","50.78533333","-1.295333333"],["31","South Bramble","G","50.783","-1.295333333"],["33","Prince Consort","BY","50.7735","-1.292666667"],["39","Snowden","Y","50.77","-1.295833333"],["4B","Coronation","Y","50.82583333","-1.293666667"],["4C","Rigit UK Rigging","Y","50.82016667","-1.291"],["4E","Mike Till","Y","50.7945","-1.283333333"],["4F","Deloitte Sailing Club","Y","50.78666667","-1.283333333"],["4G","Cutter","Y","50.82416667","-1.281833333"],["4H","East Knoll","G","50.79933333","-1.2805"],["4J","hamblewinterseries.com","Y","50.8105","-1.2775"],["4K","Royal London YC","Y","50.76916667","-1.2775"],["4L","William","Y","50.81716667","-1.274833333"],["4M","Hill Head","R","50.80116667","-1.266666667"],["4N","QXI International","Y","50.78783333","-1.265"],["4P","West Ryde Middle","YBY","50.77466667","-1.263166667"],["4Q","Robin Culpan","Y","50.80766667","-1.262"],["4R","Darling Buoy","Y","50.81966667","-1.261833333"],["4S","Royal Southern","Y","50.81466667","-1.2595"],["4T","Norris","R","50.76616667","-1.2585"],["4U","Fever Tree","Y","50.77383333","-1.2515"],["4V","Hamble Yacht Services","Y","50.80216667","-1.244"],["4W","Goodall Roofing","Y","50.78883333","-1.243166667"],["4X","Colette","Y","50.75883333","-1.239833333"],["4Y","North Ryde Middle","R","50.77683333","-1.2385"],["4Z","South Ryde Middle","G","50.76883333","-1.236"],["40","Fastnet Insurance","Y","50.79433333","-1.2275"],["41","East Bramble","BYB","50.78716667","-1.227333333"],["42","Peel Bank","R","50.75816667","-1.2225"],["43","Wightlink","Y","50.76933333","-1.218166667"],["44","Royal Yacht Squadron","Y","50.7885","-1.201666667"],["45","South East Ryde Middle","YB","50.7655","-1.201666667"],["46","North East Ryde Middle","R","50.77016667","-1.198"],["47","Maraval","Y","50.795","-1.254166667"],["5A","Quarr","Y","50.7505","-1.198166667"],["5B","Motherbank","R","50.75816667","-1.186833333"],["5C","Browndown","G","50.77616667","-1.1825"],["5D","Kemps Quay","Y","50.753","-1.160833333"],["5E","Darling Associates Architects","Y","50.771","-1.146"],["5F","North Sturbridge","BY","50.7555","-1.137166667"],["5G","RNC & RAYC","Y","50.77366667","-1.131666667"],["5J","KB Dry Stack","Y","50.77683333","-1.1215"],["5M","Gleeds","Y","50.7685","-1.108666667"],["5Q","Outer Spit","YB","50.75733333","-1.091"],["5R","Horse Sand Buoy","G","50.75883333","-1.087833333"],["5S","Saddle Buoy","G","50.75166667","-1.0825"],["50","Stokes Bay SC West","Y","50.78016667","-1.173333333"],["51","Stokes Bay SC Central","Y","50.77666667","-1.164166667"],["6A","No Man’s Land Fort","B","50.74","-1.095"],["6B","Horse Sand Fort","B","50.75016667","-1.072333333"],["6C","Warner","R","50.73116667","-1.0665"],["6D","Horse Elbow","G","50.73766667","-1.064666667"],["6E","West Princessa","YBY","50.66933333","-1.060833333"],["6F","Bembridge Ledge Buoy","BYB","50.68583333","-1.046833333"],["6G","St Helens Buoy","R","50.72266667","-1.040166667"],["6H","Dean Elbow","G","50.72816667","-1.031333333"],["6J","Nab East","R","50.71433333","-1.013333333"],["6K","Horse Tail","G","50.7205","-1.003833333"],["6L","Winner","YB","50.75166667","-1.001666667"],["6M","Nab End","R","50.7105","-0.9915"],["6N","Dean Tail","G","50.7165","-0.9861666667"],["6P","New Grounds","BYB","50.69733333","-0.9748333333"],["6R","Nab Tower","B","50.668","-0.9525"],["6S","Outer Nab No 2","BYB","50.6405","-0.9616666667"],["8S","Laid mark 8S","B","50.762","-1.249166667"],["8X","Laid mark 8X","B","50.79116667","-1.215"],["8Y","Laid mark 8Y","B","50.78333333","-1.188333333"],["8H","Laid mark 8H","B","50.73","-1.487"],["8J","Laid mark 8J","B","50.75333333","-1.416666667"],["8K","Laid mark 8K","B","50.74833333","-1.361666667"],["8A","Lendy Alpha","Y","50.7715","-1.302166667"],["8B","Lendy Beta","O","50.77","-1.302166667"],["8G","Lendy Gamma","Y","50.77083333","-1.293666667"],["8D","Lendy Delta","Y","50.77183333","-1.281666667"],["80","RYS Flagstaff","Y","50.76673333","-1.300916667"],["84","Breakwater Committee Boat","n/a","50.76983333","-1.294333333"],["01","TEST1","R","52.188020","0.120092"],["02","TEST2","G","52.188005","0.120341"],["03","TEST3","G","52.188179","0.120269"],["04","TEST4","R","52.187967","0.120076"],["05","TEST5","G","52.187826","0.120561"],["06","TEST6","G","52.187943","0.120861"],[""]]},QyWg:function(t,e,n){var a=n("RUCK");"string"==typeof a&&(a=[[t.i,a,""]]);var o={hmr:!0};o.transform=void 0;n("MTIv")(a,o);a.locals&&(t.exports=a.locals)},RUCK:function(t,e,n){e=t.exports=n("FZ+f")(!1),e.push([t.i,".course tr:nth-child(even) {background: #CCC}\n.course tr:nth-child(odd) {background: #FFF}\n.course table {\n    margin-bottom: 10px;\n    border-spacing: 0px;\n}\n.course table.marks tr:nth-child(odd) {\n    background: #faedd9\n}\n.course table.route tr:nth-child(odd) {\n    background: #dbf4db\n}\n.course tr {\n    padding:  0 0px;\n}\n.course td {\n    margin: 1px;\n}\n.course .headding {\n    font-size: 1.5em;\n}\n",""])},SSVj:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),c=n("GiK3"),d=a(c),u=n("jGla"),h=a(u),p=n("omrO"),g=a(p),m=n("45oD"),f=n("u2fu"),b=a(f);n("QyWg");var w=b.default.swiftConverter("rad","deg"),k=b.default.swiftConverter("m","nmi"),v=b.default.swiftConverter("m/s","kn"),y=function(t){function e(t){var n;i(this,e);var a=l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));a.props=t,a.gmap=new h.default("AIzaSyC1R7_R3evqRM6gsl1MTrORvGGFtbg9BjY"),a.coursePlan=new g.default({gwd:(+window.localStorage.cowes2018gwd||0)*Math.PI/180,course:window.localStorage.cowes2018Course||"",markradius:window.localStorage.cowes2018Markradius||0,tackvmgangle:(+window.localStorage.cowes2018Tackangle||42)*Math.PI/180,gybevmgangle:(+window.localStorage.cowes2018Gybeangle||142)*Math.PI/180,gws:.514444*(+window.localStorage.cowes2018gws||0),current:.514444*(+window.localStorage.cowes2018current||0),currentDirection:(+window.localStorage.cowes2018currentDirection||0)*Math.PI/180}),a.bouys={BY:"N BY",BYB:"E BYB",YB:"S YB",YBY:"W YBY"},a.state=(n={gwd:a.coursePlan.gwd,gwdInput:180*a.coursePlan.gwd/Math.PI,gws:a.coursePlan.gws,gwsInput:a.coursePlan.gws/.514444,twd:a.coursePlan.twd,tws:a.coursePlan.tws,current:a.coursePlan.current,currentInput:a.coursePlan.current/.514444,currentDirection:a.coursePlan.currentDirection,currentDirectionInput:180*a.coursePlan.currentDirection/Math.PI,course:a.coursePlan.course,markradius:a.coursePlan.markradius,tackvmgangle:a.coursePlan.tackvmgangle,tackvmgangleInput:180*a.coursePlan.tackvmgangle/Math.PI,gybevmgangle:a.coursePlan.gybevmgangle,gybevmgangleInput:180*a.coursePlan.gybevmgangle/Math.PI,marksDb:a.coursePlan.marksDb,position:a.coursePlan.position,lat:"",lon:"",geostate:"init",displayChart:"true"==window.localStorage.cowes2018DisplayChart,displayInputs:"true"===window.localStorage.cowes2018DisplayInputs,displayRacePlan:"true"===window.localStorage.cowes2018DisplayRacePlan},o(n,"displayChart","true"===window.localStorage.cowes2018DisplayChart),o(n,"displayMarks","true"===window.localStorage.cowes2018DisplayMarks),o(n,"markradius",+window.localStorage.cowes2018Markradius||50),n),a.coursePlan.update(a.state,{force:!0}),console.log("Initial state ",a.state.route.slice()),a.changeGwd=a.changeGwd.bind(a),a.changeCourse=a.changeCourse.bind(a),a.getLocation=a.getLocation.bind(a),a.positionError=a.positionError.bind(a),a.changeGeostate=a.changeGeostate.bind(a),a.changeMarkradius=a.changeMarkradius.bind(a),a.changeGws=a.changeGws.bind(a),a.changeCurrent=a.changeCurrent.bind(a),a.changeCurrentDirection=a.changeCurrentDirection.bind(a),a.changeTackVMGAngle=a.changeTackVMGAngle.bind(a),a.changeGybeVMGAngle=a.changeGybeVMGAngle.bind(a),a.toggleMarks=a.toggleMarks.bind(a),a.toggleChart=a.toggleChart.bind(a),a.toggleRacePlan=a.toggleRacePlan.bind(a),a.toggleInputs=a.toggleInputs.bind(a),a.updateGmap=a.updateGmap.bind(a),a.nextWp=a.nextWp.bind(a),a.prevWp=a.prevWp.bind(a);var r=a;return setTimeout(function(){var t={coords:{accuracy:r.state.position.accuracy,altitude:r.state.position.altitude,altitudeAccuracy:r.state.position.altitudeAccuracy,heading:90,speed:4.11,latitude:50.78783333,longitude:-1.265},timestamp:Date.now()};r.getLocation(t)},2e3),a}return r(e,t),s(e,[{key:"componentDidMount",value:function(){this.gmap.init(this.updateGmap)}},{key:"componentWillReceiveProps",value:function(t){}},{key:"componentWillUnmount",value:function(){}},{key:"positionError",value:function(t){this.setState({geostate:"no fix"+t.message}),console.log("Position Fix"+t)}},{key:"getLocation",value:function(t){if("user"!==!this.state.geostate){console.log("Got position",t);var e={accuracy:t.coords.accuracy,altitude:t.coords.altitude,altitudeAccuracy:t.coords.altitudeAccuracy,heading:t.coords.heading*Math.PI/180,speed:t.coords.speed,timestamp:t.timestamp,latlon:new m.LatLonSpherical(t.coords.latitude,t.coords.longitude)},n={lat:m.Dms.toLat(e.latlon.lat,"dm",3),lon:m.Dms.toLon(e.latlon.lon,"dm",3),position:e,geostate:"fix"};this.coursePlan.update(n,{position:e}),console.log("Possition Update"),this.setState(n)}}},{key:"mToDisplay",value:function(t){return void 0===t||null===t?"":t<100?t.toFixed(0)+" m":k(t).toFixed(1)+" nm"}},{key:"radToDisplay",value:function(t){return void 0===t||null===t?"":w(t).toFixed(0)+"°"}},{key:"symToDisplay",value:function(t){return void 0!==this.bouys[t]?this.bouys[t]:t}},{key:"msToDisplay",value:function(t){return void 0===t||null===t?"0.0":v(t).toFixed(1)+" kn"}},{key:"durationToDisplay",value:function(t){return void 0===t||null===t?"-":("0000"+Math.floor(t/3600)).substr(-3)+":"+("0000"+Math.floor(t%3600/60)).substr(-2)+":"+("0000"+Math.floor(t%60)).substr(-2)}},{key:"degToDisplay",value:function(t){return void 0===t||null===t?"-":t.toFixed(1)}},{key:"renderRouteTable",value:function(){var t=[],e=-1;void 0!==this.state.nextmark&&(e=this.state.nextmark.idx);for(var n=0;n<this.state.route.length;n++){var a=this.state.route[n];void 0===a.wp?t.push(d.default.createElement("tr",{key:n},d.default.createElement("td",null,e==n?"⇨":""),d.default.createElement("td",null,a.id),d.default.createElement("td",null),d.default.createElement("td",null,"???"),d.default.createElement("td",null),d.default.createElement("td",null),d.default.createElement("td",null),d.default.createElement("td",null),d.default.createElement("td",null),d.default.createElement("td",null))):t.push(d.default.createElement("tr",{key:n},d.default.createElement("td",null,e==n?"⇨":""),d.default.createElement("td",null,a.wp.name),d.default.createElement("td",null,a.rounding),d.default.createElement("td",null,a.wp.desc),d.default.createElement("td",{className:"bouy"+a.wp.sym},this.symToDisplay(a.wp.sym)),d.default.createElement("td",null,a.wp.latlon.toString("dm",3)),d.default.createElement("td",null,this.radToDisplay(a.btw)),d.default.createElement("td",null,this.mToDisplay(a.dtw)),d.default.createElement("td",null,this.mToDisplay(a.dist)),d.default.createElement("th",null,this.radToDisplay(a.twa))))}return d.default.createElement("table",{className:"route"},d.default.createElement("tbody",null,d.default.createElement("tr",{key:"header"},d.default.createElement("th",null,"Next"),d.default.createElement("th",null,"ID"),d.default.createElement("th",null,"Rounding"),d.default.createElement("th",null,"Name"),d.default.createElement("th",null,"Bouy"),d.default.createElement("th",null,"latlon"),d.default.createElement("th",null,"BTW(M)"),d.default.createElement("th",null,"DTW"),d.default.createElement("th",null,"Total"),d.default.createElement("th",null,"TWA")),t))}},{key:"renderMarksTable",value:function(){var t=[];for(var e in this.state.marksDb){var n=this.state.marksDb[e];t.push(d.default.createElement("tr",{key:n.name},d.default.createElement("td",null,n.name),d.default.createElement("td",null,n.desc),d.default.createElement("td",{className:"bouy"+n.sym},this.symToDisplay(n.sym)),d.default.createElement("td",null,n.latlon.toString("dm",3))))}return d.default.createElement("table",{className:"marks"},d.default.createElement("tbody",null,d.default.createElement("tr",{key:"header"},d.default.createElement("th",null,"Name"),d.default.createElement("th",null,"Desc"),d.default.createElement("th",null,"Type"),d.default.createElement("th",null,"Position")),t))}},{key:"renderCurrent",value:function(){if(console.log("Render Current ",this.state.nextmark),0===this.state.route.length||void 0==this.state.nextmark.idx||void 0==this.state.route[this.state.nextmark.idx])return d.default.createElement("div",null,"No route defined");var t;return t=this.state.nextmark.tackll?this.state.nextmark.tackll:this.state.nextmark.gybell?this.state.nextmark.gybell:{port:{btw:void 0,dtw:void 0,ttg:void 0},stbd:{btw:void 0,dtw:void 0,ttg:void 0}},d.default.createElement("table",{className:"current"},d.default.createElement("tbody",null,d.default.createElement("tr",null,d.default.createElement("th",null,"ID"),d.default.createElement("th",null,"DTW"),d.default.createElement("th",null,"BTW"),d.default.createElement("th",null,"WCV"),d.default.createElement("th",null,"TTG"),d.default.createElement("th",null,"PBTW"),d.default.createElement("th",null,"PDTW"),d.default.createElement("th",null,"PTTG"),d.default.createElement("th",null,"SBTW"),d.default.createElement("th",null,"SDTW"),d.default.createElement("th",null,"STTG")),d.default.createElement("tr",null,d.default.createElement("td",null,this.state.nextmark.id),d.default.createElement("td",null,this.mToDisplay(this.state.nextmark.dtw)),d.default.createElement("td",null,this.radToDisplay(this.state.nextmark.btw)),d.default.createElement("td",null,this.msToDisplay(this.state.nextmark.wcv)),d.default.createElement("td",null,this.durationToDisplay(this.state.nextmark.ttg)),d.default.createElement("td",null,this.radToDisplay(t.port.btw)),d.default.createElement("td",null,this.mToDisplay(t.port.dtw)),d.default.createElement("td",null,this.durationToDisplay(t.port.ttg)),d.default.createElement("td",null,this.radToDisplay(t.stbd.btw)),d.default.createElement("td",null,this.mToDisplay(t.stbd.dtw)),d.default.createElement("td",null,this.durationToDisplay(t.stbd.ttg)))))}},{key:"changeGwd",value:function(t){var e=t.target.value,n={gwdInput:e};window.localStorage.cowes2018gwd=e,this.coursePlan.update(n,{gwd:+e*Math.PI/180}),this.setState(n)}},{key:"changeGws",value:function(t){var e=t.target.value,n={gwsInput:e};window.localStorage.cowes2018gws=e,this.coursePlan.update(n,{gws:.514444*+e}),this.setState(n)}},{key:"changeCurrent",value:function(t){var e=t.target.value,n={currentInput:e};window.localStorage.cowes2018current=e,this.coursePlan.update(n,{current:.514444*+e}),this.setState(n)}},{key:"changeCurrentDirection",value:function(t){var e=t.target.value,n={currentDirectionInput:e};window.localStorage.cowes2018currentDirection=e,this.coursePlan.update(n,{currentDirection:+e*Math.PI/180}),this.setState(n)}},{key:"changeTackVMGAngle",value:function(t){var e=t.target.value,n={tackvmgangleInput:e};window.localStorage.cowes2018Tackangle=e,this.coursePlan.update(n,{tackvmgangle:+e*Math.PI/180}),this.setState(n)}},{key:"changeGybeVMGAngle",value:function(t){var e=t.target.value,n={gybevmgangleInput:e};window.localStorage.cowes2018Gybeangle=e,this.coursePlan.update(n,{gybevmgangle:+e*Math.PI/180}),this.setState(n)}},{key:"changeCourse",value:function(t){var e=t.target.value,n={course:e};window.localStorage.cowes2018Course=e,this.coursePlan.update(n,{course:e}),this.setState(n)}},{key:"changeMarkradius",value:function(t){var e=t.target.value,n={markradius:e};window.localStorage.cowes2018Markradius=e,this.coursePlan.update(n,{markradius:+e}),this.setState(n)}},{key:"changeGeostate",value:function(t){this.setState({geostate:t.target.value}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(this.getLocation,this.positionError,{enableHighAccuracy:!0,maximumAge:3e4,timeout:27e3})}},{key:"updateGmap",value:function(){this.gmap.update(this.state)}},{key:"nextWp",value:function(){var t={},e=this.state.nextmark.idx||0;e++,this.coursePlan.update(t,{nextmarkidx:e}),this.setState(t)}},{key:"prevWp",value:function(){var t={},e=this.state.nextmark.idx||0;e--,this.coursePlan.update(t,{nextmarkidx:e}),this.setState(t)}},{key:"toggleMarks",value:function(){window.localStorage.cowes2018DisplayMarks=!this.state.displayMarks,this.setState({displayMarks:!this.state.displayMarks})}},{key:"displayMarks",value:function(){return this.state.displayMarks?(this.gmap.plotMarks(this.state.marksDb),d.default.createElement("div",null,d.default.createElement("div",{className:"headding",onClick:this.toggleMarks},"▿"," Available Marks"),this.renderMarksTable())):(this.gmap.clearMarks(),d.default.createElement("div",null,d.default.createElement("div",{className:"headding",onClick:this.toggleMarks},"▹"," Available Marks")))}},{key:"toggleChart",value:function(){window.localStorage.cowes2018DisplayChart=!this.state.displayChart,this.setState({displayChart:!this.state.displayChart})}},{key:"displayChart",value:function(){return this.state.displayChart?d.default.createElement("div",null,d.default.createElement("div",{className:"headding",onClick:this.toggleChart},"▿"," Chart"),d.default.createElement("div",{id:"map"})):d.default.createElement("div",null,d.default.createElement("div",{className:"headding",onClick:this.toggleChart},"▹"," Chart"),d.default.createElement("div",{id:"map",className:"hidden"}))}},{key:"toggleRacePlan",value:function(){window.localStorage.cowes2018DisplayRacePlan=!this.state.displayRacePlan,this.setState({displayRacePlan:!this.state.displayRacePlan})}},{key:"displayRacePlan",value:function(){return this.state.displayRacePlan?d.default.createElement("div",null,d.default.createElement("div",{className:"headding",onClick:this.toggleRacePlan},"▿"," Race Plan"),this.renderRouteTable()):d.default.createElement("div",null,d.default.createElement("div",{className:"headding",onClick:this.toggleRacePlan},"▹"," Race Plan"))}},{key:"toggleInputs",value:function(){window.localStorage.cowes2018DisplayInputs=!this.state.displayInputs,this.setState({displayInputs:!this.state.displayInputs})}},{key:"displayInputs",value:function(){return this.state.displayInputs?d.default.createElement("div",null,d.default.createElement("div",{className:"headding",onClick:this.toggleInputs},"▿"," Inputs"),"All inputs are saved on your device.",d.default.createElement("div",null,"Course ",d.default.createElement("input",{name:"course",type:"text",value:this.state.course,onChange:this.changeCourse})),d.default.createElement("div",null,"GWD    ",d.default.createElement("input",{name:"gwd",type:"number",value:this.state.gwdInput,step:"1",min:"0",max:"359",onChange:this.changeGwd}),"TWD ",this.radToDisplay(this.state.twd)),d.default.createElement("div",null,"GWS    ",d.default.createElement("input",{name:"gws",type:"number",value:this.state.gwsInput,min:"0",onChange:this.changeGws}),"TWS ",this.msToDisplay(this.state.tws)),d.default.createElement("div",null,"Current    ",d.default.createElement("input",{name:"current",type:"number",value:this.state.currentInput,min:"0",onChange:this.changeCurrent})),d.default.createElement("div",null,"Current dir    ",d.default.createElement("input",{name:"currentdeg",type:"number",value:this.state.currentDirectionInput,step:"1",min:"0",max:"359",onChange:this.changeCurrentDirection})),d.default.createElement("div",null,"Target VMG TWA Upwind  ",d.default.createElement("input",{name:"tackvmgangleInput",type:"number",value:this.state.tackvmgangleInput,step:"1",min:"0",max:"90",onChange:this.changeTackVMGAngle})),d.default.createElement("div",null,"Target VMG TWA Downwind  ",d.default.createElement("input",{name:"gybevmgangleInput",type:"number",value:this.state.gybevmgangleInput,step:"1",min:"90",max:"180",onChange:this.changeGybeVMGAngle})),d.default.createElement("div",null,"WP Radius    ",d.default.createElement("input",{name:"markradius",type:"number",value:this.state.markradius,min:"0",onChange:this.changeMarkradius})),d.default.createElement("div",null,d.default.createElement("button",{onClick:this.prevWp},"Previous"),d.default.createElement("button",{onClick:this.nextWp},"Next"))):d.default.createElement("div",null,d.default.createElement("div",{className:"headding",onClick:this.toggleInputs},"▹"," Inputs"))}},{key:"fixStatus",value:function(){return"fix"==this.state.geostate?"☉":"init"==this.state.geostate?"◌":"☁ "+this.state.geostate}},{key:"render",value:function(){return this.updateGmap(),d.default.createElement("div",{className:"course"},d.default.createElement("hr",null),d.default.createElement("div",null,"Position:",this.state.position.latlon.toString("dm",3)," ",this.fixStatus()),d.default.createElement("div",null,"SOG:",this.msToDisplay(this.state.position.speed)),d.default.createElement("div",null,"COG:",this.radToDisplay(this.state.position.heading)),d.default.createElement("div",null,"ts:",this.state.position.timestamp),this.renderCurrent(),this.displayRacePlan(),this.displayChart(),this.displayMarks(),this.displayInputs(),d.default.createElement("div",{className:"headding"},"Weather Links"),d.default.createElement("a",{href:"https://weatherfile.com/GBR000014&wt=KTS"},"Lymington Starting Platform"),d.default.createElement("a",{href:"https://weatherfile.com/RPR000154&wt=KTS"},"Ryde Pier"),d.default.createElement("a",{href:"https://weatherfile.com/GBR00002&wt=KTS"},"Hurst Castle"),d.default.createElement("a",{href:"https://weatherfile.com/GBR00004&wt=KTS"},"Pool"))}}]),e}(d.default.Component);e.default=y},jGla:function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=function(){function t(e){a(this,t),this.key=e,this.initMap=this.initMap.bind(this),this.cbid="gmapInit"+Date.now(),window[this.cbid]=this.initMap,this.doneinit=!1}return o(t,[{key:"init",value:function(t){if(this.cbinit=t,!this.doneinit){console.log("Load Maps");var e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key="+this.key+"&callback="+this.cbid,e.async=!0,e.defer=!0,document.body.appendChild(e),this.doneinit=!0}}},{key:"initMap",value:function(){var t=this.getMapCenter();console.log("maps init called ",t),this.map=new google.maps.Map(document.getElementById("map"),{center:t,zoom:11}),this.cbinit()}},{key:"update",value:function(t){console.log("Plotting state ",t),this.plotRoute(t.route,t.routeVersion,t.nextmark),void 0!==t.nextmark&&this.plotCurrentMarker(t.nextmark.idx,t.routeVersion),this.plotBoat(t)}},{key:"plotRoute",value:function(t,e,n){var a=this;if(void 0!=t&&void 0!==this.map&&this.plottedVersion!==e){void 0!==this.routeMarks&&this.routeMarks.map(function(t){void 0!==t&&t.setMap(null)}),void 0!==this.routeToFinish&&this.routeToFinish.setMap(null),this.routeMarks=t.map(function(t,e){if(void 0!==t.wp)return new window.google.maps.Marker({position:{lat:t.wp.latlon.lat,lng:t.wp.latlon.lon},label:t.spec,icon:a.getMarkIcon(t,n.id),map:a.map});console.log("No wp ",t)});for(var o=[],i=0;i<t.length;i++)void 0!==t[i].wp&&o.push({lat:t[i].wp.latlon.lat,lng:t[i].wp.latlon.lon});this.routeToFinish=new google.maps.Polyline({path:o,geodesic:!0,strokeColor:"#000000",strokeOpacity:1,strokeWeight:2,icons:[{icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW},offset:"100%",repeat:"100px"}]}),this.routeToFinish.setMap(this.map),this.plottedroute=t.slice();var l=this.getMapCenter(t);this.map.setCenter(l),this.plottedVersion=e}}},{key:"getMarkIcon",value:function(t,e){return t.id===e?{path:google.maps.SymbolPath.CIRCLE,fillColor:"green",fillOpacity:.8,scale:10,strokeColor:"black",strokeWeight:1}:{path:google.maps.SymbolPath.CIRCLE,fillColor:"yellow",fillOpacity:.8,scale:10,strokeColor:"black",strokeWeight:1}}},{key:"plotLines",value:function(t,e){void 0!=t&&void 0!==t.wp&&t.routeVersion!==e&&(t.routeVersion=e,this.clearLines(),this.lines=[],this.lines.push(new google.maps.Polyline({path:[{lat:t.portLLStart.lat,lng:t.portLLStart.lon},{lat:t.wp.latlon.lat,lng:t.wp.latlon.lon}],geodesic:!0,map:this.map,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2,icons:[{icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW},offset:"75%"}]})),this.lines.push(new google.maps.Polyline({path:[{lat:t.stbdLLStart.lat,lng:t.stbdLLStart.lon},{lat:t.wp.latlon.lat,lng:t.wp.latlon.lon}],geodesic:!0,map:this.map,strokeColor:"#00FF00",strokeOpacity:1,strokeWeight:2,icons:[{icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW},offset:"75%"}]})),this.lines.push(new google.maps.Polyline({path:[{lat:t.portLLStart.lat,lng:t.portLLStart.lon},{lat:t.tidePoint.lat,lng:t.tidePoint.lon}],geodesic:!0,map:this.map,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:1,icons:[{icon:{path:google.maps.SymbolPath.FORWARD_OPEN_ARROW},offset:"75%"}]})),this.lines.push(new google.maps.Polyline({path:[{lat:t.stbdLLStart.lat,lng:t.stbdLLStart.lon},{lat:t.tidePoint.lat,lng:t.tidePoint.lon}],geodesic:!0,map:this.map,strokeColor:"#00FF00",strokeOpacity:1,strokeWeight:1,icons:[{icon:{path:google.maps.SymbolPath.FORWARD_OPEN_ARROW},offset:"75%"}]})),this.lines.push(new google.maps.Polyline({path:[{lat:t.tidePoint.lat,lng:t.tidePoint.lon},{lat:t.wp.latlon.lat,lng:t.wp.latlon.lon}],geodesic:!0,map:this.map,strokeColor:"#00FFFF",strokeOpacity:1,strokeWeight:1,icons:[{icon:{path:google.maps.SymbolPath.FORWARD_OPEN_ARROW},offset:"75%",repeat:"20px"}]})))}},{key:"clearLines",value:function(){if(void 0!==this.lines){for(var t=0;t<this.lines.length;t++)this.lines[t].setMap(null),this.lines[t]=void 0;this.lines=void 0}}},{key:"plotCurrentMarker",value:function(t,e){void 0!==this.routeMarks&&(void 0===this.currentmarkerno?void 0!==this.routeMarks[t]&&(this.routeMarks[t].setIcon(this.getMarkIcon(this.plottedroute[t],this.plottedroute[t].id)),this.plottedroute[t].routeVersion=void 0,this.markerVersion=e):this.currentmarkerno===t&&this.markerVersion!=e||(void 0!==this.routeMarks[this.currentmarkerno]&&(this.routeMarks[this.currentmarkerno].setIcon(this.getMarkIcon(this.plottedroute[this.currentmarkerno],"")),this.plottedroute[this.currentmarkerno].routeVersion=void 0,this.clearLines()),void 0!==this.routeMarks[t]&&(this.routeMarks[t].setIcon(this.getMarkIcon(this.plottedroute[t],this.plottedroute[t].id)),this.plottedroute[t].routeVersion=void 0,this.markerVersion=e)),this.plotLines(this.plottedroute[t],e),this.currentmarkerno=t)}},{key:"plotMarks",value:function(t){if(void 0==this.markers&&void 0!==this.map){this.markers=[];for(var e in t)this.markers.push(new window.google.maps.Marker({position:{lat:t[e].latlon.lat,lng:t[e].latlon.lon},label:t[e].name,map:this.map}))}}},{key:"clearMarks",value:function(){void 0!==this.markers&&(this.markers.map(function(t){t.setMap(null)}),this.markers=void 0)}},{key:"plotBoat",value:function(t){if(void 0!==t.position&&void 0!==this.map){this.position=t.position;var e={lat:this.position.latlon.lat,lng:this.position.latlon.lon};console.log("Drawing boat at ",e),void 0===this.boatMark?this.boatMark=new window.google.maps.Marker({position:e,label:"B",map:this.map}):this.boatMark.setPosition(e);var n={path:"M 0,-1 0,1",strokeOpacity:1,scale:2},a={path:"M 0,-1 0,1",strokeOpacity:1,strokeWeight:2,scale:1};if(void 0!==this.trackLines)for(var o=0;o<this.trackLines.length;o++)this.trackLines[o].setMap(null);this.trackLines=[];var i=this.plottedroute[this.currentmarkerno];void 0!==i&&void 0!==i.wp&&this.trackLines.push(new google.maps.Polyline({path:[{lat:this.position.latlon.lat,lng:this.position.latlon.lon},{lat:i.wp.latlon.lat,lng:i.wp.latlon.lon}],map:this.map,geodesic:!0,strokeColor:"#FFFFFF",strokeOpacity:0,icons:[{icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW},offset:"95%"},{icon:n,offset:"0",repeat:"20px"}]}));var l=void 0;if(void 0!==t.nextmark&&void 0!==t.nextmark.tackll?l=t.nextmark.tackll:void 0!==t.nextmark&&void 0!==t.nextmark.gybell&&(l=t.nextmark.gybell),void 0!==l&&(void 0!==l.port&&null!==l.port.intersect.latlon&&(this.trackLines.push(new google.maps.Polyline({path:[{lat:this.position.latlon.lat,lng:this.position.latlon.lon},{lat:l.port.intersect.latlon.lat,lng:l.port.intersect.latlon.lon}],map:this.map,geodesic:!0,strokeColor:"#00FF00",strokeOpacity:0,icons:[{icon:a,offset:"0",repeat:"10px"}]})),this.trackLines.push(new google.maps.Polyline({path:[{lat:l.port.intersect.latlon.lat,lng:l.port.intersect.latlon.lon},{lat:i.wp.latlon.lat,lng:i.wp.latlon.lon}],map:this.map,geodesic:!0,strokeColor:"#FF0000",strokeOpacity:0,icons:[{icon:a,offset:"0",repeat:"10px"}]}))),void 0!==l.stbd&&null!==l.stbd.intersect.latlon&&(this.trackLines.push(new google.maps.Polyline({path:[{lat:this.position.latlon.lat,lng:this.position.latlon.lon},{lat:l.stbd.intersect.latlon.lat,lng:l.stbd.intersect.latlon.lon}],map:this.map,geodesic:!0,strokeColor:"#FF0000",strokeOpacity:0,icons:[{icon:a,offset:"0",repeat:"10px"}]})),this.trackLines.push(new google.maps.Polyline({path:[{lat:l.stbd.intersect.latlon.lat,lng:l.stbd.intersect.latlon.lon},{lat:i.wp.latlon.lat,lng:i.wp.latlon.lon}],map:this.map,geodesic:!0,strokeColor:"#00FF00",strokeOpacity:0,icons:[{icon:a,offset:"0",repeat:"10px"}]})))),this.position.speed>.1){var r=this.position.latlon.destinationPoint(600*this.position.speed,180*this.position.heading/Math.PI);this.trackLines.push(new google.maps.Polyline({path:[{lat:this.position.latlon.lat,lng:this.position.latlon.lon},{lat:r.lat,lng:r.lon}],map:this.map,geodesic:!0,strokeColor:"#00FF00",strokeOpacity:0,icons:[{icon:n,offset:"0",repeat:"10px"}]}))}var s=this.position.latlon.destinationPoint(1100,(t.twd+2*Math.PI)%(2*Math.PI)*180/Math.PI),c=s.destinationPoint(1e3,(t.twd-Math.PI+2*Math.PI)%(2*Math.PI)*180/Math.PI);this.trackLines.push(new google.maps.Polyline({path:[{lat:s.lat,lng:s.lon},{lat:c.lat,lng:c.lon}],geodesic:!0,map:this.map,strokeColor:"#0000FF",strokeOpacity:1,strokeWeight:2,icons:[{icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW},offset:"100%"}]}));var d=1e3;t.tws>.1&&(d=1e3*t.gws/t.tws);var u=this.position.latlon.destinationPoint(d+100,(t.gwd+2*Math.PI)%(2*Math.PI)*180/Math.PI),h=u.destinationPoint(d,(t.gwd-Math.PI+2*Math.PI)%(2*Math.PI)*180/Math.PI);this.trackLines.push(new google.maps.Polyline({path:[{lat:u.lat,lng:u.lon},{lat:h.lat,lng:h.lon}],geodesic:!0,map:this.map,strokeColor:"#0000FF",strokeOpacity:1,strokeWeight:1,icons:[{icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW},offset:"100%"}]}));var p=1e3;t.tws>.1&&(p=1e3*t.current/t.tws);var g=this.position.latlon.destinationPoint(p+100,(t.currentDirection+2*Math.PI)%(2*Math.PI)*180/Math.PI),m=g.destinationPoint(p,(t.currentDirection-Math.PI+2*Math.PI)%(2*Math.PI)*180/Math.PI);this.trackLines.push(new google.maps.Polyline({path:[{lat:m.lat,lng:m.lon},{lat:g.lat,lng:g.lon}],geodesic:!0,map:this.map,strokeColor:"#00FFFF",strokeOpacity:1,strokeWeight:2,icons:[{icon:{path:google.maps.SymbolPath.FORWARD_CLOSED_ARROW},offset:"100%"}]}))}}},{key:"getMapCenter",value:function(t){if(void 0!==t&&t.length>0){var e=-100,n=-360,a=100,o=360;return t.map(function(t){void 0!==t.wp&&(e=Math.max(e,t.wp.latlon.lat),a=Math.min(a,t.wp.latlon.lat),n=Math.max(n,t.wp.latlon.lon),o=Math.min(o,t.wp.latlon.lon))}),-100==e?{lat:50.7480015,lng:-1.4703211}:{lat:(e+a)/2,lng:(n+o)/2}}return void 0!==this.position?{lat:this.position.latlon.lat,lng:this.position.latlon.lon}:{lat:50.7480015,lng:-1.4703211}}}]),t}();e.default=i},omrO:function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n("Ki9h"),l=function(t){return t&&t.__esModule?t:{default:t}}(i),r=n("45oD"),s=function(){function t(e){a(this,t),console.log("CoursePlan props ",e),this.course=e.course||"",this.gwd=+e.gwd||0,this.gws=+e.gws||0,this.current=e.current||0,this.currentDirection=e.currentDirection||0,this.markradius=+e.markradius||50,this.tackvmgangle=+e.tackvmgangle||42*Math.PI/180,this.gybevmgangle=+e.gybevmgangle||142*Math.PI/180,this.position=e.position||{accuracy:0,altitude:null,altitudeAccuracy:-1,heading:0,speed:0,timestamp:0,latlon:new r.LatLonSpherical(50.78783333,-1.265)},this.nextmarkidx=e.nextmarkidx||0,this.roundings={P:"port",S:"starboard",PP:"pass port",PS:"pass starboard",T:"pass through"},this.loadMarks(),this.nextmark={idx:-1,id:"",xte:null,dtw:null,btw:null,wcv:null,ttg:null,laylinebearing:null,laylinedistance:null,laylinettg:null}}return o(t,[{key:"update",value:function(t,e){console.log("Update:",e);var n=!1,a=!1,o=!1;e.force&&(o=!0,n=!0),void 0!==e.markradius&&(this.markradius=e.markradius),void 0!==e.position&&(this.position=e.position,a=!0),void 0!==e.nextmarkidx&&e.nextmarkidx!==this.nextmarkidx&&(this.nextmarkidx=e.nextmarkidx,a=!0),void 0!==e.gwd&&e.gwd!==this.gwd&&(this.gwd=e.gwd,t.gwd=this.gwd,o=!0,n=!0),void 0!==e.gws&&e.gws!==this.gws&&(this.gws=e.gws,t.gws=this.gws,o=!0,n=!0),void 0!==e.current&&e.current!==this.current&&(this.current=e.current,t.current=this.current,o=!0,n=!0),void 0!==e.currentDirection&&e.currentDirection!==this.currentDirection&&(this.currentDirection=e.currentDirection,t.currentDirection=this.currentDirection,o=!0,n=!0),void 0!==e.course&&e.course!==this.course&&(this.course=e.course,n=!0),o&&this.calcWind(t),n?this.buildRoute(t):a&&this.updateNextmark(t)}},{key:"loadMarks",value:function(){this.marksDb={};for(var t={},e=l.default[0],n=0;n<e.length;n++)t[e[n]]=n;for(var n=1;n<l.default.length;n++){var e=l.default[n];this.marksDb[e[t.name]]={name:e[t.name],desc:e[t.desc],sym:e[t.sym],latlon:new r.LatLonSpherical(e[t.lat],e[t.lon])}}}},{key:"calcWind",value:function(t){var e=[];e=[Math.sin(this.gwd)*this.gws,Math.cos(this.gwd)*this.gws],e=[e[0]+Math.sin(this.currentDirection)*this.current,e[1]+Math.cos(this.currentDirection)*this.current],0===e[0]&&0===e[1]?(this.twd=this.gwd,this.tws=this.gws):(this.twd=Math.atan2(e[0],e[1]),this.tws=Math.sqrt(e[0]*e[0]+e[1]*e[1])),t.twd=this.twd,t.tws=this.tws,t.gws=this.gws,t.gwd=this.gwd,t.current=this.current,t.currentDirection=this.currentDirection}},{key:"buildRoute",value:function(t){var e=[],n=this.course.trim().replace("\n",",").split(",");console.log("Building route for ",this.course," as ",n);for(var a=0;a<n.length;a++){var o=n[a].toUpperCase();if(""!=o){var i={id:o.substring(0,2),spec:o,rounding:this.roundings[o.substring(2)],wp:this.marksDb[o.substring(0,2)]};e.push(i)}else console.log("ID is empty ",o)}var l=0;this.calcBTWDTW(e[0],this.position);for(var a=1;a<e.length;a++)e[a].dist=l,this.calcBTWDTW(e[a],e[a-1].wp),l+=e[a].dtw;this.route=e,this.updateDynamic(),this.updateNextmark(t),t.route=this.route,t.routeVersion=Date.now()}},{key:"calcBTWDTW",value:function(t,e){void 0!==e&&void 0!==t&&void 0!==t.wp&&(t.dtw=e.latlon.rhumbDistanceTo(t.wp.latlon),t.btw=e.latlon.rhumbBearingTo(t.wp.latlon)*Math.PI/180)}},{key:"toRelativeAngle",value:function(t){return t>Math.PI?t-2*Math.PI:t<-Math.PI?t+2*Math.PI:t}},{key:"updateDynamic",value:function(){if(this.route.length>0&&void 0!==this.twd)for(var t=0;t<this.route.length;t++){var e=this.route[t];void 0!==e.btw&&(e.twa=this.toRelativeAngle(this.twd-e.btw),e.tidePoint=e.wp.latlon.destinationPoint(300*this.current,this.toDeg(this.currentDirection+Math.PI)),e.twa<Math.PI/2&&e.twa>-Math.PI/2?(e.stbdLLStart=e.tidePoint.destinationPoint(300*this.position.speed,this.toDeg(this.twd-this.tackvmgangle+Math.PI)),e.portLLStart=e.tidePoint.destinationPoint(300*this.position.speed,this.toDeg(this.twd+this.tackvmgangle+Math.PI)),e.tack=!0,e.stbdLLBTW=e.stbdLLStart.rhumbBearingTo(e.wp.latlon)*Math.PI/180,e.portLLBTW=e.portLLStart.rhumbBearingTo(e.wp.latlon)*Math.PI/180):(e.stbdLLStart=e.tidePoint.destinationPoint(300*this.position.speed,this.toDeg(this.twd-this.gybevmgangle+Math.PI)),e.portLLStart=e.tidePoint.destinationPoint(300*this.position.speed,this.toDeg(this.twd+this.gybevmgangle+Math.PI)),e.tack=!1,e.stbdLLBTW=e.stbdLLStart.rhumbBearingTo(e.wp.latlon)*Math.PI/180,e.portLLBTW=e.portLLStart.rhumbBearingTo(e.wp.latlon)*Math.PI/180),e.twd=this.twd,e.tws=this.tws,e.gwd=this.gwd,e.gws=this.gws,e.tackvmgangle=this.tackvmgangle,e.gybevmgangle=this.gybevmgangle)}}},{key:"updateNextmark",value:function(t){var e=t.route||this.route;if(0!==e.length){this.updateDynamic(e);this.nextmarkidx;(void 0===this.nextmarkidx||this.nextmarkidx<0)&&(this.nextmarkidx=0),this.nextmark.advancewp&&this.nextmarkidx++,this.nextmarkidx>=e.length&&(this.nextmarkidx=e.length-1);var n=e[this.nextmarkidx],a=e[this.nextmarkidx].wp,o={idx:this.nextmarkidx,id:e[this.nextmarkidx].id,xte:null,dtw:null,btw:null,ttg:null,wcv:null};if(void 0!==this.position&&void 0!==a){o.dtw=this.position.latlon.rhumbDistanceTo(a.latlon),o.btw=this.position.latlon.rhumbBearingTo(a.latlon)*Math.PI/180,o.twa=this.toRelativeAngle(this.twd-o.btw);var i=void 0;o.dtw<this.markradius&&(o.advancewp=!0),void 0!=this.position.speed&&void 0!==this.position.heading&&(i=Math.cos(o.btw-this.position.heading),o.wcv=this.position.speed*i,o.ttg=o.dtw/o.wcv);var l,r;if(console.log("Next wp ",a),Math.abs(o.twa)<this.tackvmgangle&&void 0!==n.portLLBTW){l=this.tackvmgangle,o.tackll=r={port:{btw:n.portLLBTW},stbd:{btw:n.stbdLLBTW}};var s=(2*Math.PI+r.port.btw-a.btw)%2*Math.PI;s<2*l?r.between=!0:s<Math.PI-l?r.stdbover=!0:r.portover=!0,this.calcIntesects(r,a)}else if(Math.abs(o.twa)>this.gybevmgangle&&void 0!==n.portLLBTW){l=this.gybevmgangle,o.gybell=r={port:{btw:n.portLLBTW},stbd:{btw:n.stbdLLBTW}};var s=(2*Math.PI+r.port.btw-a.btw)%2*Math.PI;s<this.gybevmgangle?r.portover=!0:s<2*Math.PI-2*(Math.PI-this.gybevmgangle)?r.stdbover=!0:r.between=!0,this.calcIntesects(r,a)}}this.nextmark=o,t.nextmark=o}}},{key:"toDeg",value:function(t){return(t+2*Math.PI)%(2*Math.PI)*180/Math.PI}},{key:"calcIntesects",value:function(t,e){var n=t.port.intersect={latlon:r.LatLonSpherical.intersection(this.position.latlon,this.toDeg(t.stbd.btw),e.latlon,this.toDeg(t.port.btw-Math.PI))},a=t.stbd.intersect={latlon:r.LatLonSpherical.intersection(this.position.latlon,this.toDeg(t.port.btw),e.latlon,this.toDeg(t.stbd.btw-Math.PI))};null!==n.latlon&&(n.dti=this.position.latlon.rhumbDistanceTo(n.latlon),n.itw=n.latlon.rhumbDistanceTo(e.latlon),t.port.dtw=n.dti+n.itw,this.position.speed>.1?t.port.ttg=t.port.dtw/this.position.speed:t.port.ttg=-1),null!==a.latlon&&(a.dti=this.position.latlon.rhumbDistanceTo(a.latlon),a.itw=a.latlon.rhumbDistanceTo(e.latlon),t.stbd.dtw=a.dti+a.itw,this.position.speed>.1?t.stbd.ttg=t.stbd.dtw/this.position.speed:t.stbd.ttg=-1);var o=t.port.heading={latlon:r.LatLonSpherical.intersection(this.position.latlon,this.toDeg(this.position.heading),e.latlon,this.toDeg((t.port.btw-Math.PI)%(2*Math.PI)))},i=t.stbd.heading={latlon:r.LatLonSpherical.intersection(this.position.latlon,this.toDeg(this.position.heading),e.latlon,this.toDeg((t.stbd.btw-Math.PI)%(2*Math.PI)))};null!==i.latlon&&(i.dti=this.position.latlon.rhumbDistanceTo(i.latlon),o.itw=i.latlon.rhumbDistanceTo(e.latlon),o.tti=i.dti/this.position.speed,o.ttw=(i.dti+i.itw)/this.position.speed),null!==o.latlon&&(o.dti=this.position.latlon.rhumbDistanceTo(o.latlon),i.itw=o.latlon.rhumbDistanceTo(e.latlon),i.tti=o.dti/this.position.speed,i.ttw=(o.dti+o.itw)/this.position.speed)}}]),t}();e.default=s},qYAe:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),s=n("GiK3"),c=a(s),d=n("O27J"),u=n("SSVj"),h=a(u);n("GcMe");var p=function(t){function e(t){o(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));n.props=t,n.sourcePriority=t.sourcePriority;return n.state={},n}return l(e,t),r(e,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return console.log("Starting to render"),c.default.createElement("div",null,c.default.createElement(h.default,null))}}]),e}(c.default.Component),g=c.default.createElement(p,{sourcePriority:""});console.log("Now Running"),(0,d.render)(g,document.getElementById("react"))},y4E4:function(t,e,n){e=t.exports=n("FZ+f")(!1),e.push([t.i,"\n\n/*@font-face {\n   font-family: 'MyFont';\n   src:  url('./fontawesome-webfont.woff2') format('woff2'),\n         url('./fontawesome-webfont.woff') format('woff');\n   font-weight: 600;\n   font-style: normal;\n}*/\n\n/*\nbody {\n  font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n}\n\n*/\n\n/*.checkcssworking {\n  color: red;\n  background: url('./icon.png');\n  font-family: 'MyFont';\n}*/\n\n/* SVG UI Day and cs_night */\n\n\n.hidden {\n  display: none;\n}\n\n\n.cs_normal {\n    stroke: black;\n    fill: black;\n    background-color: white;\n    color: black;\n}\n\n.cs_invert {\n    stroke: white;\n    fill: white;\n    background-color: black;\n    color: white;\n}\n\n.cs_night {\n    stroke: red;\n    fill: red;\n    background-color: black;\n    color: red;\n}\n\n\n\n\n\n\n\n.react-grid-layout {\n  position: relative;\n  transition: height 200ms ease;\n}\n.react-grid-item {\n  transition: all 200ms ease;\n  transition-property: left, top;\n}\n.react-grid-item.cssTransforms {\n  transition-property: transform;\n}\n.react-grid-item.resizing {\n  z-index: 1;\n  will-change: width, height;\n}\n\n.react-grid-item.react-draggable-dragging {\n  transition: none;\n  z-index: 3;\n  will-change: transform;\n}\n\n.react-grid-item.react-grid-placeholder {\n  background: red;\n  opacity: 0.2;\n  transition-duration: 100ms;\n  z-index: 2;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  -o-user-select: none;\n  user-select: none;\n}\n\n.react-grid-item > .react-resizable-handle {\n  position: absolute;\n  width: 20px;\n  height: 20px;\n  bottom: -6px;\n  right: -6px;\n  cursor: se-resize;\n}\n\n.cs_normal .react-grid-item > .react-resizable-handle::after {\n  content: \"\";\n  position: absolute;\n  right: 3px;\n  bottom: 3px;\n  width: 5px;\n  height: 5px;\n  border-right: 2px solid rgba(0, 0, 0, 0.4);\n  border-bottom: 2px solid rgba(0, 0, 0, 0.4);\n}\n\n.cs_invert .react-grid-item > .react-resizable-handle::after, .cs_night .react-grid-item > .react-resizable-handle::after {\n  content: \"\";\n  position: absolute;\n  right: 3px;\n  bottom: 3px;\n  width: 5px;\n  height: 5px;\n  border-right: 2px solid rgba(255, 0, 0, 0.4);\n  border-bottom: 2px solid rgba(255, 0, 0, 0.4);\n}\n\n\n.react-resizable {\n  position: relative;\n}\n.react-resizable-handle {\n  position: absolute;\n  width: 20px;\n  height: 20px;\n  bottom: 0;\n  right: 0;\n  background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2IDYiIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiNmZmZmZmYwMCIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI2cHgiIGhlaWdodD0iNnB4Ij48ZyBvcGFjaXR5PSIwLjMwMiI+PHBhdGggZD0iTSA2IDYgTCAwIDYgTCAwIDQuMiBMIDQgNC4yIEwgNC4yIDQuMiBMIDQuMiAwIEwgNiAwIEwgNiA2IEwgNiA2IFoiIGZpbGw9IiMwMDAwMDAiLz48L2c+PC9zdmc+');\n  background-position: bottom right;\n  padding: 0 3px 3px 0;\n  background-repeat: no-repeat;\n  background-origin: content-box;\n  box-sizing: border-box;\n  cursor: se-resize;\n}\n\n\n.settings {\n    position: absolute;\n    top: 40px;\n    left: 40px;\n    right: 40px;\n    bottom: 40px;\n    border: 1px solid rgb(204, 204, 204);\n    background: rgb(255, 255, 255);\n    overflow: auto;\n    border-radius: 10px;\n}\n.cs_invert .settings {\n    border: 1px solid rgb(204, 204, 204);\n    background: rgb(0, 0, 0);\n}\n\n.cs_night .settings {\n    border: 1px solid #c00;\n    background: rgb(0, 0, 0);\n}\n\n.settings_after-open {\n}\n.settings_before-close {\n}\n.settings_before-close {\n\n}\n.settingsOverlay {\n    position: fixed; \n    top: 0px; \n    left: 0px; \n    right: 0px; \n    bottom: 0px; \n}\n.cs_normal .settingsOverlay, .cs_night .settingsOverlay {\n    background-color: rgba(150, 150, 150, 0.75);\n}\n\n.cs_invert .settingsOverlay, .cs_night .settingsOverlay {\n    background-color: rgba(50, 50, 50, 0.75);\n}\n.settingsOverlay_after-open {\n\n}\n.settingsOverlay_before-close {\n}\n\n.globalSettingsButton {\n    position: absolute;\n    right: 10px;\n    top: 10px;        \n}\n\n.globalSettingsButton > button {\n    border: none;\n    background-color: inherit;\n    color: inherit;\n    font-size: 16px;\n    outline: none;\n}\n\n\n\n.settingsClose {\n    position: absolute;\n    right: 5px;\n    top: 5px;    \n    background-color: transparent;\n    color: inherit;\n}\n\n.settingsClose > button {\n    border: none;\n    outline: none;\n    background-color: transparent;\n    color: inherit;\n}\n\n.settingsApply {\n    position: absolute;\n    right: 136px;\n    bottom: 17px;\n}\n\n.settingsApply > input {\n    border: solid;\n    font-size: 16px;\n    background-color: #92b3e6;\n    border-color: #a0b2c1;\n    border-width: 1px;\n    border-radius: 5px;\n    padding-top: 8px;\n    padding-left: 30px;\n    padding-right: 30px;\n    padding-bottom: 8px;\n}\n\n.cs_invert .settingsApply > input {\n    background-color: #92b3e67a;\n    border-color: #a0b2c187;\n    color: inherit;\n}\n\n.cs_night .settingsApply > input {\n    background-color: #ff0000d4;\n    border-color: #f00;\n    color: #222;\n}\n\n\n.settingsCancel {\n    position: absolute;\n    right: 17px;\n    bottom: 17px;\n}\n\n.settingsCancel > button {\n    background-color: transparent;\n    color: inherit;\n    border: solid #797676;\n    font-size: 16px;\n    border-width: 1px;\n    border-radius: 5px;\n    padding-top: 8px;\n    padding-left: 30px;\n    padding-right: 30px;\n    padding-bottom: 8px;\n    outline: none;\n}\n\n.cs_invert .settingsCancel > button {\n    border-color: solid #aaa;\n}\n\n.cs_night .settingsCancel > button {\n    border-color: solid #a00;\n}\n\n.tabControls {\n    position: absolute;\n    font-size: 16px;\n    top: 5px;\n    right: 1px;\n}\n\n\n.tabControls > button {\n    border: none;\n    padding-left: 1px;\n    padding-right: 1px;\n    outline: none;\n    background-color: inherit;\n    color: inherit;\n}\n\n\n.dropDown {\n    position: absolute;\n    left: -1px;\n    top: 29px;\n    padding: 16px;\n    border-top: none;\n    border-left: solid 1px;\n    border-radius: 3px;\n    z-index: 3;\n    border-bottom: solid 1px;\n    border-right: solid 1px;\n    border-top-left-radius: 0px;\n    border-top-right-radius: 0px;\n    border-bottom-right-radius: 8px;\n    border-bottom-left-radius: 8px;\n    width: 129px;\n    padding: 2px;\n}\n\n.cs_normal .dropDown {\n    background-color: #ccccccf7;  \n}\n\n.cs_invert .dropDown {\n    background-color: #ccccccf7;  \n}\n.cs_night .dropDown {\n    background-color: #ccccccf7;  \n}\n\n.dropDown > button {\n    border: none;\n    background-color: inherit;\n    color: inherit;\n    outline: none;\n}\n\n\n.cellControls {\n    position: absolute;\n    font-size: 10px;\n    right: -8px;\n    top: -2px;\n    z-index: 1;\n}\n\n.cellControls > button {\n    border: none;  \n    background-color: transparent;\n    color: inherit;\n    outline: none;\n}\n\n.settingsForm {\n    border: 1px solid;\n    position: fixed;\n    left: 90px;\n    right: 25%;\n    top: 90px;\n    padding: 10px;\n    overflow: auto;\n    display: grid;\n    grid-gap: 11px;\n}\n\n.settingsForm label {\n    grid-column: 1 / 2;\n}\n\n.settingsForm input  {\n    grid-column: 2 / 2;\n    background-color: inherit;\n    color: inherit;\n}\n\n.cs_night .settingsForm input  {\n  border-color: #c00;\n}\n\n\n.settingsForm select {\n    grid-column: 2 / 2;\n    background-color: inherit;\n    color: inherit;\n}\n\n.cs_night .settingsForm select  {\n  border-color: #c00;\n}\n\n\n.settingsForm .help {\n    grid-column: 2 / 2;\n   font-size: 10px;\n}\n\n.settingsForm .settingsGroup {\n    display: grid;\n    grid-gap: 11px;\n    grid-column: 2 / 2;\n}\n\n.settingsForm .settingsGroup > div {\n    grid-column: 2 / 2;\n}\n\n\n/* Canvas based instruments */\n\n.cellContainer {\n  position: absolute;\n  top: 0px;\n  left: 0px; \n  right: 0px;  \n}\n\n.instrumentContainer {\n  font-family: sans-serif;\n  position: absolute;\n  top: 0px;\n  left: 0px; \n}\n.canvasHolder {\n  position: absolute;\n  top: 0px;\n  left: 0px; \n}\n.instrumentContainer canvas { \n  border: 1px solid black;\n  position: absolute;\n  top: 0px;\n  left: 0px; \n}\n.cs_invert .instrumentContainer canvas { \n  border: 1px solid #aaa;\n}\n.cs_night .instrumentContainer canvas { \n  border: 1px solid red;\n}\n.cs_normal .dataBoxFill {\n  background: rgba(215,215,215,0.7);      \n}\n\n.cs_invert .dataBoxFill, .cs_night .dataBoxFill  {\n  background: rgba(40,40,40,0.3);      \n}\n\n.dataBox {\n  position: absolute;\n  width: 100px;\n  height: 50px;\n  border-radius: 5px;   \n  border: 1px solid black;\n  font-size: 30px;\n  font-family: sans-serif;\n}\n\n.cs_invert .dataBox {\n  border: 1px solid white;\n}\n.cs_night .dataBox {\n  border: 1px solid red;\n}\n\n.dataBoxFull {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  border-radius: 5px;   \n  border: 1px solid black;\n  font-size: 93px;\n  font-family: sans-serif;\n}\n\n.cs_invert .dataBoxFull {\n  border: 1px solid #aaa;\n}\n\n.cs_night .dataBoxFull {\n  border: 1px solid red;\n}\n\n.dataBoxValue {\n  background-color: inherit;\n  color: inherit;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  right: 0px;\n  bottom: 0px;\n  overflow: hidden;\n  text-align: center;\n}\n\n\n.dataBoxUnits {\n  background-color: inherit;\n  color: inherit;\n  position: absolute;\n  bottom:  2px;\n  right:  2px; \n  font-size: 14px;\n}\n.dataBoxTitle {\n  background-color: inherit;\n  color: inherit;\n  position: absolute;\n  bottom:  2px;\n  left:  2px; \n  font-size: 14px;\n}\n.inputForm {\n  position: absolute;\n  right: 0px;\n}\n.inputForm > label {\n  display: block;\n}\n\n\n\n\n.stripChart .axis {\n    stroke-width: 1;\n}\n\n.cs_normal .stripChart .axis .tick line {\n    stroke: black;\n}\n.cs_invert .stripChart .axis .tick line {\n    stroke: white;\n}\n.cs_night .stripChart .axis .tick line {\n    stroke: red;\n}\n\n.cs_normal .stripChart .axis .tick text {\n    fill: black;\n    font-size: 0.7em;\n}\n.cs_invert .stripChart .axis .tick text {\n    fill: white;\n    font-size: 0.7em;\n}\n.cs_night .stripChart .axis .tick text {\n    fill: red;\n    font-size: 0.7em;\n}\n\n.cs_normal .stripChart .axis .domain {\n    fill: none;\n    stroke: black;\n}\n.cs_invert .stripChart .axis .domain {\n    fill: none;\n    stroke: white;\n}\n.cs_night .stripChart .axis .domain {\n    fill: none;\n    stroke: red;\n}\n\n.cs_normal .stripChart .group {\n    fill: none;\n    stroke: black;\n    stroke-width: 1.5;\n}\n.cs_invert .stripChart .group {\n    fill: none;\n    stroke: white;\n    stroke-width: 1.5;\n}\n.cs_night .stripChart .group {\n    fill: none;\n    stroke: red;\n    stroke-width: 1.5;\n}\n\n\n\n",""])}},["qYAe"]);