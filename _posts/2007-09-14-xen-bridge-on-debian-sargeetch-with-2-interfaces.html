---
layout: post
title: Xen Bridge on Debian Sarge/Etch with 2 interfaces
date: 2007-09-14 16:03:54.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags: []
meta: {}
author:
  login: iebtfdcouk
  email: ieb@tfd.co.uk
  display_name: Ian
  first_name: Ian
  last_name: Boston
permalink: "/2007/09/14/xen-bridge-on-debian-sargeetch-with-2-interfaces/"
---
<p>
The standard network-bridge script that comes with Xen on Debian Sarge does not appear to work. The problem appears to be that the network script after converting the hardware ethernet into a promiscuous port (peth1), and binding a virtual port veth0.1 to the bridge, it fails to binf the fake eth1 to the virtual port.</p>
<p>
I dont know if its the right solution, but binding the new fake eth1 to the bridge xenbr0, makes it all work.</p>
<pre class="prettyprint">
brctl delif xenbr0 veht0.1
brctl addif xenbr0 eth1
</pre>
<p>
Does the trick.</p>
<p>
If you want to correct the scripts change the lines</p>
<pre class="prettyprint">
       ip link set ${bridge} up
       add_to_bridge  ${bridge} ${vif0}
        add_to_bridge2 ${bridge} ${pdev}
        do_ifup ${netdev}
</pre>
<p>to</p>
<pre class="prettyprint">
       ip link set ${bridge} up
        add_to_bridge  ${bridge} ${netdev}
        add_to_bridge2 ${bridge} ${pdev}
        do_ifup ${netdev}
</pre>
<p>and</p>
<pre class="prettyprint">
      brctl delif ${bridge} ${pdev}
        brctl delif ${bridge} ${vid0}
        ip link set ${bridge} down
</pre>
<p>to</p>
<pre class="prettyprint">
      brctl delif ${bridge} ${pdev}
        brctl delif ${bridge} ${netdev}
        ip link set ${bridge} down
</pre>
