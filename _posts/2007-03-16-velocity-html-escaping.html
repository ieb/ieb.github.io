---
layout: post
title: Velocity HTML Escaping
date: 2007-03-16 10:40:56.000000000 +00:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Thought
tags: []
meta:
  _oembed_6758d015a28f0054221bde9cd9a13059: "{{unknown}}"
  _oembed_0ad1903f5599e06f81b936763a98cba2: "{{unknown}}"
  _oembed_430c6308d084976417dce57be16ddf3c: "{{unknown}}"
  _oembed_d989c3788cd26d659d5ed68fef2997c4: "{{unknown}}"
  _oembed_7b266104d8aa963a7ec0d15112701698: "{{unknown}}"
  _oembed_43973049489ebaac6ddcc17402f4b309: "{{unknown}}"
  _oembed_644276d66e5a6bddab552378e0952ae2: "{{unknown}}"
  _oembed_e7e034bea49c861b948175fbb120e0f3: "{{unknown}}"
  _oembed_5aa4bf18184ceae19f839862dd800c91: "{{unknown}}"
  _oembed_b94d697f0128d03de4f321277223c6a5: "{{unknown}}"
  _oembed_d66f74404a969326899c35a5c1caee38: "{{unknown}}"
  _oembed_92b5c92d64de14d9fb0a609febdc7b08: "{{unknown}}"
  _oembed_185dd391448b7f5cf8e4f4770d1dd529: "{{unknown}}"
author:
  login: iebtfdcouk
  email: ieb@tfd.co.uk
  display_name: Ian
  first_name: Ian
  last_name: Boston
permalink: "/2007/03/16/velocity-html-escaping/"
---
<p>The age old problem often overlooked in the rush to get a UI out of the  door.... html escaping.  Some view technologies have no support for and  you are just left to do it all manually or forget, jsp. Some like RSF  just do it without even thinking about it because they are xml based.  And some have mechanisms to let you choose.</p>
<p>Velocity has an event mechanism that allows you to escape the output for  the target output format. You can either implement a handler and inject  it into the context or register one. Standard ones are based on regexes  of the variable names in template eg ${model.sqlStatement} could be  matched with /sql.*/ to escape as SQL.</p>
<p>eventhandler.referenceinsertion.class =  org.apache.velocity.app.event.implement.EscapeHtmlReference eventhandler.referenceinsertion.class =  org.apache.velocity.app.event.implement.EscapeSqlReference eventhandler.escape.html.match = /msg.*/ eventhandler.escape.sql.match = /sql.*/</p>
<p>This approach makes the escaping issue simple where the output doesnt  conform to xml formatting (eg css, Sherlock, ddl, ASN1 etc), but you  have to remember to use some conformaty in the naming of the view model  entities... not entirely a bad thing.</p>
<p>http://velocity.apache.org/engine/devel/developer-guide.html</p>
